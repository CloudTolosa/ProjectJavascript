// other themes to add ?
// bigger memory?

var library = {
    occupations: [
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/doctor_fzie1s.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/NURSE_xsgt31.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/FARMER_bnwhlq.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/FIREMAN_dgkuop.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/WAITER_hqrpxr.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/BAKER_i624tp.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/SCIENTIFIC_qwukos.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/TEACHER_tgffqx.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039790/occupations/ARCHITECT_wdxehk.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039790/occupations/PAINTER_fs56nb.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/doctor_fzie1s.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/NURSE_xsgt31.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/FARMER_bnwhlq.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/FIREMAN_dgkuop.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/WAITER_hqrpxr.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/BAKER_i624tp.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/SCIENTIFIC_qwukos.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039791/occupations/TEACHER_tgffqx.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039790/occupations/ARCHITECT_wdxehk.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602039790/occupations/PAINTER_fs56nb.png',

    ],
    food: [
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/BANANA_ecvhhk.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/BLACKBERRY_foivoy.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/STRAWBERRY_erzjcj.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/ORANGE_ukkl76.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/APPLE_m0chzu.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/WATERMELON_xfohew.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/COOKIE_ada0y7.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/CORN_zbwaew.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/ONION_sak7s5.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/RICE_rr4zhu.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/BANANA_ecvhhk.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/BLACKBERRY_foivoy.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/STRAWBERRY_erzjcj.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764248/food/ORANGE_ukkl76.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/APPLE_m0chzu.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/WATERMELON_xfohew.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/COOKIE_ada0y7.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/CORN_zbwaew.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/ONION_sak7s5.png',
        'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602764247/food/RICE_rr4zhu.png',
    ],
    animals: [
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765351/animals/BUTTERFLY_ji2qwk.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765351/animals/ELEPHANT_vzg5mq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/MOUSE_imzrqk.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/SNAKE_bdkrfc.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/HORSE_evigcp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/BIRD_oeh3va.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/DUCK_x4d1uq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/DOG_jwr9e7.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/CAT_i3zdh6.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/COW_gmcoqi.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765351/animals/BUTTERFLY_ji2qwk.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765351/animals/ELEPHANT_vzg5mq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/MOUSE_imzrqk.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/SNAKE_bdkrfc.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/HORSE_evigcp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/BIRD_oeh3va.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765350/animals/DUCK_x4d1uq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/DOG_jwr9e7.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/CAT_i3zdh6.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602765349/animals/COW_gmcoqi.png',
    ],
    places: [
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602798815/places/MUSEUM_qi9lpq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602798815/places/FARM_ipjgee.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/CINEMA_vszgkg.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/BAKERY_ftzlwy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/BANK_fzxxox.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/HOSPITAL_fzidcq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/DENTIST_qwi7bb.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/HOTEL_zdcvxe.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/SCHOOL_n5zqqp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/FACTORY_j4pqqu.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602798815/places/MUSEUM_qi9lpq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602798815/places/FARM_ipjgee.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/CINEMA_vszgkg.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/BAKERY_ftzlwy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794506/places/BANK_fzxxox.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/HOSPITAL_fzidcq.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/DENTIST_qwi7bb.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/HOTEL_zdcvxe.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/SCHOOL_n5zqqp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602794505/places/FACTORY_j4pqqu.png',
    ],
    bedroom: [
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802229/bedroom/BED_ihjiwa.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802227/bedroom/PILLOW_pprrhy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/BEDSIDE_w7lesu.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/ALARMCLOCK_la3ys4.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/LAMP_y9s6aw.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/CHAIR_hx1u2k.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/BLANKET_vjkjgg.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/LIGHT_f6pjma.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802224/bedroom/CURTAINS_njz2ek.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802224/bedroom/TOYS_fqrlvl.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802229/bedroom/BED_ihjiwa.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802227/bedroom/PILLOW_pprrhy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/BEDSIDE_w7lesu.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/ALARMCLOCK_la3ys4.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/LAMP_y9s6aw.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/CHAIR_hx1u2k.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/BLANKET_vjkjgg.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802226/bedroom/LIGHT_f6pjma.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802224/bedroom/CURTAINS_njz2ek.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1602802224/bedroom/TOYS_fqrlvl.png',

    ],
    routines: [
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GETUP_ah6mq9.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/TAKESHOWER_v1rpcu.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GETDRESSED_lfowfp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/BRUSHTEETH_tnjtad.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/EATBREAKFAST_lhalyz.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/PLAY_wkzr39.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/HOMEWORK_xazvq9.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042203/routines/BRUSHHAIR_y4h8dy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042203/routines/GOBED_zxmbw6.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GOSCHOOL_mltauy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GETUP_ah6mq9.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/TAKESHOWER_v1rpcu.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GETDRESSED_lfowfp.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/BRUSHTEETH_tnjtad.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/EATBREAKFAST_lhalyz.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/PLAY_wkzr39.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/HOMEWORK_xazvq9.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042203/routines/BRUSHHAIR_y4h8dy.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042203/routines/GOBED_zxmbw6.png',
      'https://res.cloudinary.com/drqr9l8n4/image/upload/v1603042204/routines/GOSCHOOL_mltauy.png',

    ]
  }
  
  var images = [],
      tempElt1 = "",
      tempElt2 = "",
      click = -1,
      win = 0,
      score = 0,
      time = 0;
  
  var preElt = document.querySelector("#pre"),
      themesElt = document.querySelector("#themes"),
      boxElts = document.getElementsByClassName("box"),
      mainElt = document.querySelector(".main"),
      timeElt = document.querySelector("#time"),
      scoreElt = document.querySelector("#score"),
      postElt = document.querySelector("#post"),
      finalElt = document.querySelector("#final"),
      againElt = document.querySelector("#again");
  
  
  // initiate the game with chosen theme
  themesElt.addEventListener("click", function(e) {
    if (e.target.classList.contains("themes")) {
      activateTheme(e.target.id);
      preElt.classList.add("hidden");
    }
  });
  
  function activateTheme(theme) {
    // insert theme in images array
    switch (theme) {
      case "occupations":
        for (let i=0; i<20; i++) {images.push(library.occupations[i]);}
        break;
      case "food":
        for (let i=0; i<20; i++) {images.push(library.food[i]);}
        break;
      case "animals":
        for (let i=0; i<20; i++) {images.push(library.animals[i]);}
        break;
      case "places":
        for (let i=0; i<20; i++) {images.push(library.places[i]);}
        break;
      case "bedroom":
        for (let i=0; i<20; i++) {images.push(library.bedroom[i]);}
        break;
      case "routines":
        for (let i=0; i<20; i++) {images.push(library.routines[i]);}
        break;
    }
    // insert images in memory game
    for (let i=0; i<20; i++) {
      var rand = Math.floor(Math.random() * (images.length-1));
      boxElts[i].innerHTML = "<img src='" + images[rand] + "' alt='image' class='hidden'>";
      images.splice(rand, 1);
    }
  }
  
  
  // Handle the play
  mainElt.addEventListener("click", gameLogic);
  
  function gameLogic(e) {
    // make sure the box is playable
    if (e.target.classList.contains("play")) {
      e.target.firstChild.classList.remove("hidden");
      // first of two click
      if (click < 1) {
        tempElt1 = e.target;
        // timer
        if (click === -1) {
          timer = setInterval(function() {
            time++;
            timeElt.innerHTML = time;
          }, 1000);
        }
        click = 1;
      }
  
      // second click
      else if (e.target !== tempElt1) {
        tempElt2 = e.target;
  
        // different images
        if (tempElt1.firstChild.src !== tempElt2.firstChild.src) {
          mainElt.removeEventListener("click", gameLogic);
          setTimeout( function() {
            tempElt1.firstChild.classList.add("hidden");
            tempElt2.firstChild.classList.add("hidden");
            mainElt.addEventListener("click", gameLogic);
          }, 400);
          if (score > 0){
            score -= 2;
          }
          scoreElt.innerHTML = score;
        }
  
        // same images
        else {
          score += 10;
          win += 2;
          tempElt1.firstChild.classList.add("outlined");
          tempElt2.firstChild.classList.add("outlined");
          tempElt1.classList.remove("play");
          tempElt2.classList.remove("play");
          scoreElt.innerHTML = score;
  
          // game won
          if (win === 20) {
            clearTimeout(timer);
            finalElt.innerHTML = "You won " + score + " points <br> in " + time + " seconds";
            postElt.classList.remove("hidden");
          }
        }
        click = 0;
      }
    }
  }
  
  againElt.addEventListener("click", resetGame);
  
  function resetGame() {
    // reset game
    tempElt1 = "";
    tempElt2 = "";
    click = -1;
    win = 0;
    score = 0;
    time = 0;
    postElt.classList.add("hidden");
    preElt.classList.remove("hidden");
    for (let i=0; i<20; i++) {
      boxElts[i].classList.add("play");
      boxElts[i].firstChild.classList.add("hidden");
    }
    timeElt.textContent = time;
    scoreElt.textContent = score;
  }
  
  // handle focus of the page
  // function checkPageFocus() {
  //   if (document.hasFocus()) {
  //     preElt.classList.remove("hidden");
  //   }
  //   else {
  //     preElt.classList.add("hidden");
  //   }
  // }
  // var checkPageInterval = setInterval(checkPageFocus, 300);
  